
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{_ as O}from"./index-74c80a46.js";import{_ as W}from"./index-c4dfb300.js";import{_ as X}from"./index.vue_vue_type_script_setup_true_name_SvgIcon_lang-dfa84782.js";import{a as Y}from"./index-6f858f68.js";import{bb as d,a$ as m,b0 as Z}from"./user-e0b78c84.js";import{N as U}from"./index-8e5ec700.js";import{b as I}from"./route-block-83d24a4e.js";import{_ as G}from"./_plugin-vue_export-helper-c27b6911.js";import{a3 as s,k as u,l as c,E as t,y as l,F as g,Y as b,x as _,C,m as q,B,Z as H}from"./runtime-core.esm-bundler-a63aef9e.js";import"./settings-9db32632.js";import"./index-c228ae8f.js";import"./vue-router-8228f7a0.js";import"./runtime-dom.esm-bundler-1ceaee55.js";const J=Z(),x={data(){return{columnFields:[],commentsData:{list:[],currPage:1,pageSize:20,total:0,totalPage:0},showEditDialog:!1,dialogTitle:"",dialogType:"",batchBtnEnable:!1,search:{pageSize:20,pageIndex:1,sortBy:"createTime",sortType:"desc",queryParams:{}},departmentTree:{},listProjects:[],listUsers:[],selectedRoles:[],confirmResultItems:[],selectedRows:[],editDetail:{},editFieldRules:{name:[{required:!0,message:"用户姓名必填",trigger:"blur"}],account:[{required:!0,message:"用户账号必填",trigger:"blur"}]}}},computed:{},mounted(){this.resetSearch(),this.getColumnFields(),this.loadUserList(),this.loadProjects(),this.loadConfirmResultItems(),this.loadDepartmentTree()},methods:{loadUserList(){d.get("server/user/getAllUserDetails").then(r=>{this.listUsers=r.data})},loadProjects(){d.get(`server/project/queryProjectInDept?deptId=${this.search.queryParams.departmentId}`).then(r=>{this.listProjects=r.data})},loadConfirmResultItems(){d.get("server/column/queryConfirmResultDictItems").then(r=>{this.confirmResultItems=r.data})},getColumnFields(){d.get("server/column/queryColumns").then(r=>{this.columnFields=r.data})},loadDepartmentTree(){d.get("server/dept/getDeptTree").then(r=>{this.departmentTree=r.data})},clickSearch(){d.post("/server/comment/queryComments",this.search).then(r=>{this.commentsData=r.data})},resetSearch(){this.search.queryParams={identifier:null,projectId:null,departmentId:null,commitUser:J.account,realConfirmUser:null,assignConfirmUser:null,confirmResult:null},this.clickSearch()},handleSizeChange(r){this.search.pageSize=r,this.clickSearch()},handleCurrentChange(r){this.search.pageIndex=r,this.clickSearch()},getSelectedRows(r){this.selectedRows=r,this.selectedRows&&this.selectedRows.length!==0?this.batchBtnEnable=!0:this.batchBtnEnable=!1},deleteSelection(r){U.confirm("确定要删除所选记录吗？此操作不可恢复！","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const a=[];for(let p=0;p<this.selectedRows.length;p++){const V=this.selectedRows[p];a.push(V.identifier)}d.get(`server/comment/deleteComments?identifiers=${a}`).then(p=>{p.code===0?m({type:"success",message:"删除成功"}):m({type:"error",message:`删除失败：${p.message}`}),this.clickSearch()})}).catch(()=>{})},deleteSingle(r){U.confirm("确定要删除此记录吗？此操作不可恢复！","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{d.get(`server/comment/deleteComment?identifier=${r.identifier}`).then(a=>{a.code===0?m({type:"success",message:"删除成功"}):m({type:"error",message:`删除失败：${a.message}`}),this.clickSearch()})}).catch(()=>{})},viewSingle(r){d.get(`server/comment/initViewReqBody?identifier=${r.identifier}`).then(a=>{this.editDetail=a.data,this.dialogTitle="评审意见详情",this.dialogType="VIEW",this.showEditDialog=!0}).catch(a=>{m({type:"error",message:`编辑失败：${a}`})})},editSingle(r){d.get(`server/comment/initEditReqBody?identifier=${r.identifier}`).then(a=>{this.editDetail=a.data,this.dialogTitle="修改评审意见",this.dialogType="EDIT",this.showEditDialog=!0}).catch(a=>{m({type:"error",message:`编辑失败：${a.message}`})})},saveOperation(){this.$refs.editDetailForm.validate(r=>{if(!r)m({type:"error",message:"参数内容填写有误，请检查"});else{let a;if(this.dialogType==="CREATE")a="server/comment/createComment";else if(this.dialogType==="EDIT")a="server/comment/modifyComment";else if(this.dialogType==="CONFIRM")a="server/comment/confirmComment";else{m({type:"error",message:"请求操作类型不合法"});return}d.post(a,this.editDetail).then(p=>{p.code===0?(m({type:"success",message:"保存成功"}),this.showEditDialog=!1,this.clickSearch()):m({type:"error",message:`编辑失败：${p.message}`})})}})},cancelEditOperation(){this.showEditDialog=!1},create(){d.get("server/comment/initCreateReqBody").then(r=>{this.editDetail=r.data,this.dialogTitle="添加评审意见",this.dialogType="CREATE",this.showEditDialog=!0}).catch(r=>{m({type:"error",message:`编辑失败：${r}`})})},cancelCreateOperation(){this.showEditDialog=!1},confirmSingle(r){d.get(`server/comment/initConfirmReqBody?identifier=${r.identifier}`).then(a=>{this.editDetail=a.data,this.dialogTitle="评审意见确认",this.dialogType="CONFIRM",this.showEditDialog=!0}).catch(a=>{m({type:"error",message:`编辑失败：${a}`})})}}};const K={class:"button-group"},Q={key:0},$={class:"dialog-footer"};function ee(r,a,p,V,i,n){const A=Y,D=s("el-option"),v=s("el-select"),h=s("el-form-item"),E=s("el-col"),S=s("el-row"),F=s("el-input"),z=s("el-tree-select"),k=X,w=s("el-icon"),f=s("el-button"),P=s("el-form"),M=W,R=O,T=s("el-table-column"),N=s("el-table"),j=s("el-pagination"),L=s("el-dialog");return u(),c("div",null,[t(A,{title:"我提交的",content:"本页面展示所有您提交的检视意见，您可以在此页面查看、编辑、删除已提交的内容，或者新建并提交新的检视意见。"}),t(R,{title:"搜索条件"},{default:l(()=>[t(M,null,{default:l(()=>[t(P,{model:i.search,size:"default","label-width":"120px"},{default:l(()=>[t(S,null,{default:l(()=>[t(E,{span:6},{default:l(()=>[t(h,{label:"指派确认人员"},{default:l(()=>[t(v,{modelValue:i.search.queryParams.assignConfirmUser,"onUpdate:modelValue":a[0]||(a[0]=e=>i.search.queryParams.assignConfirmUser=e),modelModifiers:{trim:!0},placeholder:"请输入姓名或账号查询",clearable:"",filterable:""},{default:l(()=>[(u(!0),c(g,null,b(i.listUsers,(e,o)=>(u(),_(D,{key:e.account,label:e.name,value:e.account},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(E,{span:6},{default:l(()=>[t(h,{label:"实际确认人员"},{default:l(()=>[t(v,{modelValue:i.search.queryParams.realConfirmUser,"onUpdate:modelValue":a[1]||(a[1]=e=>i.search.queryParams.realConfirmUser=e),modelModifiers:{trim:!0},placeholder:"请输入姓名或账号查询",clearable:"",filterable:""},{default:l(()=>[(u(!0),c(g,null,b(i.listUsers,(e,o)=>(u(),_(D,{key:e.account,label:e.name,value:e.account},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(E,{span:6},{default:l(()=>[t(h,{label:"确认结果"},{default:l(()=>[t(v,{modelValue:i.search.queryParams.confirmResult,"onUpdate:modelValue":a[2]||(a[2]=e=>i.search.queryParams.confirmResult=e),modelModifiers:{trim:!0},placeholder:"输入评审意见的确认状态",clearable:""},{default:l(()=>[(u(!0),c(g,null,b(i.confirmResultItems,(e,o)=>(u(),_(D,{key:e.value,label:e.showName,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(S,null,{default:l(()=>[t(E,{span:6},{default:l(()=>[t(h,{label:"唯一ID"},{default:l(()=>[t(F,{modelValue:i.search.queryParams.identifier,"onUpdate:modelValue":a[3]||(a[3]=e=>i.search.queryParams.identifier=e),placeholder:"输入评审意见唯一ID进行查询",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),t(E,{span:6},{default:l(()=>[t(h,{label:"归属部门"},{default:l(()=>[t(z,{modelValue:i.search.queryParams.departmentId,"onUpdate:modelValue":a[4]||(a[4]=e=>i.search.queryParams.departmentId=e),data:i.departmentTree,"render-after-expand":!1,"check-strictly":"true",onChange:n.loadProjects},null,8,["modelValue","data","onChange"])]),_:1})]),_:1}),t(E,{span:6},{default:l(()=>[t(h,{label:"归属项目"},{default:l(()=>[t(v,{modelValue:i.search.queryParams.projectId,"onUpdate:modelValue":a[5]||(a[5]=e=>i.search.queryParams.projectId=e),modelModifiers:{trim:!0},placeholder:"请选择",clearable:"",filterable:""},{default:l(()=>[(u(!0),c(g,null,b(i.listProjects,(e,o)=>(u(),_(D,{key:e.id,label:e.projectName,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(h,null,{default:l(()=>[t(f,{type:"primary",onClick:n.clickSearch},{icon:l(()=>[t(w,null,{default:l(()=>[t(k,{name:"ep:search"})]),_:1})]),default:l(()=>[C(" 查询 ")]),_:1},8,["onClick"]),t(f,{onClick:n.resetSearch},{default:l(()=>[C(" 重置 ")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),t(R,null,{default:l(()=>[q("div",K,[t(f,{type:"primary",onClick:n.create},{icon:l(()=>[t(w,null,{default:l(()=>[t(k,{name:"ep:circle-plus"})]),_:1})]),default:l(()=>[C(" 新建 ")]),_:1},8,["onClick"]),t(f,{type:"danger",disabled:!i.batchBtnEnable,onClick:n.deleteSelection},{icon:l(()=>[t(w,null,{default:l(()=>[t(k,{name:"ep:delete"})]),_:1})]),default:l(()=>[C(" 删除所选 ")]),_:1},8,["disabled","onClick"])]),t(N,{border:"","highlight-current-row":"",data:i.commentsData.list,height:"100%",onSelectionChange:n.getSelectedRows},{default:l(()=>[t(T,{type:"selection",width:"55"}),(u(!0),c(g,null,b(i.columnFields,(e,o)=>(u(),c(g,null,[e.showInWebTable?(u(),_(T,{key:e.columnCode,prop:e.columnCode,label:e.showName,width:e.webTableColumnWidth,index:o},null,8,["prop","label","width","index"])):B("",!0)],64))),256)),t(T,{fixed:"right",label:"操作",width:"200"},{default:l(e=>[t(f,{link:"",type:"primary",size:"small",onClick:o=>n.viewSingle(e.row)},{default:l(()=>[C(" 查看 ")]),_:2},1032,["onClick"]),t(f,{link:"",type:"primary",size:"small",onClick:o=>n.editSingle(e.row)},{default:l(()=>[C(" 编辑 ")]),_:2},1032,["onClick"]),t(f,{link:"",type:"danger",size:"small",onClick:o=>n.deleteSingle(e.row)},{default:l(()=>[C(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","onSelectionChange"]),t(j,{class:"pageination-style",background:"",layout:"total, sizes, prev, pager, next, jumper","page-size":i.commentsData.pageSize,total:i.commentsData.total,"current-page":i.commentsData.currPage,onSizeChange:n.handleSizeChange,onCurrentChange:n.handleCurrentChange},null,8,["page-size","total","current-page","onSizeChange","onCurrentChange"])]),_:1}),t(L,{modelValue:i.showEditDialog,"onUpdate:modelValue":a[6]||(a[6]=e=>i.showEditDialog=e),title:i.dialogTitle},H({default:l(()=>[t(P,{ref:"editDetailForm",model:i.editDetail,size:"default","label-width":"120px",rules:i.editFieldRules},{default:l(()=>[(u(!0),c(g,null,b(i.editDetail.fieldModelList,(e,o)=>(u(),c(g,null,[e.show?(u(),c("div",Q,[e.inputType=="TEXT"?(u(),_(h,{key:0,label:e.showName},{default:l(()=>[t(F,{modelValue:i.editDetail.fieldModelList[o].valuePair.value,"onUpdate:modelValue":y=>i.editDetail.fieldModelList[o].valuePair.value=y,disabled:e.editable===!1},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1032,["label"])):B("",!0),e.inputType=="COMBO_BOX"?(u(),_(h,{key:1,label:e.showName},{default:l(()=>[t(v,{modelValue:i.editDetail.fieldModelList[o].valuePair,"onUpdate:modelValue":y=>i.editDetail.fieldModelList[o].valuePair=y,disabled:e.editable===!1,filterable:""},{default:l(()=>[(u(!0),c(g,null,b(e.enumValues,y=>(u(),_(D,{label:y.showName,value:y},null,8,["label","value"]))),256))]),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1032,["label"])):B("",!0),e.inputType=="TEXTAREA"?(u(),_(h,{key:2,label:e.showName},{default:l(()=>[t(F,{modelValue:i.editDetail.fieldModelList[o].valuePair.value,"onUpdate:modelValue":y=>i.editDetail.fieldModelList[o].valuePair.value=y,rows:5,disabled:e.editable===!1,type:"textarea"},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1032,["label"])):B("",!0)])):B("",!0)],64))),256))]),_:1},8,["model","rules"])]),_:2},[i.dialogType!=="VIEW"?{name:"footer",fn:l(()=>[q("span",$,[t(f,{onClick:n.cancelEditOperation},{default:l(()=>[C(" 取消 ")]),_:1},8,["onClick"]),t(f,{type:"primary",onClick:n.saveOperation},{default:l(()=>[C(" 保存 ")]),_:1},8,["onClick"])])]),key:"0"}:void 0]),1032,["modelValue","title"])])}typeof I=="function"&&I(x);const he=G(x,[["render",ee],["__scopeId","data-v-71227267"]]);export{he as default};
//# sourceMappingURL=mycommittedcomment-98462d6f.js.map
