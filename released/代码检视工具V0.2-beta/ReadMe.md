# CodeReview代码检视-团队版服务端部署说明

## 依赖条件

- JDK8+
- MySQL
- MongoDB

## 部署说明

1. 准备好MySQL、MongoDB
2. 执行`initial_db.sql`对MySQL进行初始化操作
3. 修改`config/application-PROD.properties`文件中的配置，填写正确的数据库连接信息
4. 根据部署系统的不同，执行`start.bat`或者`start.sh`，启动服务
5. 访问`http://localhost:23560`可以查看到登录界面，使用预置账号`codereview/123456`可以登录进入系统。

## 使用说明

1. 用户创建后默认密码统一为`123456`，可以登录后点击右上角进行账号密码修改
2. 如果需要发送通知的能力（比如提交检视意见之后微信/钉钉通知对应人员），可以修改下配置文件`config/application-PROD.properties`中的`application.notice.webhook.url`值，可以配置一个自己实现的接口，用来接收CodeReview数据变更推送，然后转发到自己团队对应的通知渠道中
3. 部署之后，在使用前，需要按照团队的实际情况，维护下`部门信息`与`项目信息`，以方便更好的去使用系统
4. 可以针对自身团队的实际情况，对代码review记录的字段信息进行配置调整，可以添加自己需要的一些字段
5. 服务端界面可以独立使用，但是为了获取最佳体验，强烈建议在IDEA中安装对应的插件来配套使用，以获取最佳的使用体验

## IDEA插件说明

> 注意： IDEA仅支持`2019.03`及以上版本的IDEA进行安装，低于此版本的无法安装。

1. 使用本地安装的方式将`idea-plugin\IntellijIDEA-CodeReview-Plugin.zip`文件安装到IDEA中，安装方式：

![](https://pics.codingcoder.cn/pics/202307202149710.gif)

2. 安装完成后，在IDEA主界面下方，可以看到CodeReview的页签：

![](https://pics.codingcoder.cn/pics/202307202156189.png)

3. 打开idea插件界面进行网络版本配置：

点击`settings`按钮，打开设置界面，可以切换界面中英文显示，然后切换到`网络版本`：

![](https://pics.codingcoder.cn/pics/202307202157298.png)

在网络版本中，输入搭建好的服务端地址，点击`连接测试`成功后，再输入账号和密码，点击`登录测试`,验证成功后即可点击下方的`保存按钮`。

![](https://pics.codingcoder.cn/pics/202307202201121.png)

4. 设置完成后，会自动从服务端拉取已经配置好的评审字段配置信息、以及服务端的项目信息列表等。使用过程中用户也可以手动点击`同步配置`按钮，从服务端拉取最新的配置信息。

![](https://pics.codingcoder.cn/pics/202307202202880.png)

5. 代码评审的时候，选中代码内容，然后`alt+a`可以打开添加评审意见的窗口，在窗口中添加评审信息后点击保存即可完成评审意见的添加。

![](https://pics.codingcoder.cn/pics/202307202207769.png)

6. 按住`alt`按钮，并点击对应记录，可以弹出确认窗口，可以对别人提的评审意见进行确认。

![](https://pics.codingcoder.cn/pics/202307202209616.png)

7. 双击评审意见表格中黄色的区域，可以直接在表格中修改对应字段的值；双击评审意见表格中白色区域，可以直接跳转到评审意见对应的代码位置

8. 代码中被提过评审意见的地方，代码行号旁边会有对应标识提醒（刚添加评审意见之后不会出现，必须要关闭当前类再次打开的时候才会出现）

![](https://pics.codingcoder.cn/pics/202307202208616.png)

9. 点击`提交服务端`，可以将本地的评审意见内容提交到服务端（如果有配置webhook通知，会收到相关消息推送）

![](https://pics.codingcoder.cn/pics/202307202210345.png)

10. 选择具体项目以及拉取范围后，点击`服务端下载`可以从服务端拉取评审意见到本地IDEA中。比如别人给我提了评审意见，我可以拉取到自己的IDEA中，双击跳转到对应的代码位置，进行问题的确认处理，确认完成后，可以在本地IDEA中对评审意见进行答复，答复完成后提交本地数据到服务端，完成整个review过程的闭环。

![](https://pics.codingcoder.cn/pics/202307202212457.png)

## 其他说明

1. IDEA插件的默认快捷键是`alt+a`，如果需要修改，可以到IDEA的settings里面进行修改。